#### 2021-12-28 To Do List

1. ë“œë¦¼ì½”ë”© ìë°”ìŠ¤í¬ë¦½íŠ¸ (11~13 +a)
2. í¬íŠ¸í´ë¦¬ì˜¤ ì ê²€
3. í¬íŠ¸í´ë¦¬ì˜¤ í´ë¡ ì½”ë”© ê²°ì œ

#### 2021-12-28 Done List

### 11.Callback

//JavaScript is synchronous.
//Execute the code block in order after hoisting.
//hoisting: var,function declaration ( ìë™ì ìœ¼ë¡œ ê°€ì¥ ìƒë‹¨ìœ¼ë¡œ ì˜¬ë¼ê°. )
console.log('1');
setTimeout(()=>console.log('2'), 1000);
console.log('3');

//Synchronous callback

    function printImmediately(print){
    print();
    }
    printImmediately(()=> console.log('hello'));

//Asychronous callback
function printWithDelay(print,timeout);
setTimeout(print,timeout);
}

    printWithDelay(()=>console.log('async callback'),2000);

//Callback Hell Example

    class UserStorage{
    loginUser(id,password,onSuccess,onError){
        setTimeout(()=?{
            if(
                (id==="ellie" && password==="dream")||
                (id==="coder" && password==="academy")
            ) {
                onSuccess(id);
            } else {
                onError(new Error('not found'));
            }
        },2000)
    }
    getRoles(user,onSuccess,onError){
        setTimeoust(()=>{
            if(user==="ellie"){
                onSuccess({name:"ellie",role:"admin"});
            }else{
                onError(new Error('no acess'));
            }
        },1000)
        }
    }
    const useStorage= new UserStorage();
    const id =prompt('enter your id');
    const password =propmt('enter you password');

    userStorage.loginUser(
        id,
        password,
        user=>{
            userStorage.getRoles(
                user,
                userWithRole => {
                    alert(`Hello ${userWirhRole.name}, you have a ${userWirhRole.role} role`);
                    },
                error => {
                    console.log(error);
                    }
                );
            },
        error => {
            console.log(error);
        }
    );

=>ê°€ë…ì„±ì´ ë–¨ì–´ì§€ê³  ì—ëŸ¬ê°€ ë‚ ê²½ìš° ì—ëŸ¬ê°€ ì–´ë””ì—ì„œ ë‚¬ëŠ”ì§€ ì°¾ê¸°ê°€ í˜ë“¤ë‹¤.

### 12.Promise is a JavaScript object for asynchronous operation.

// State : peding -> fuifilled or rejected
// Producer / Consumer ì°¨ì´ì 

1. Producer
   //when new Promise is created, the executor runs automatically.
   -> ì´ ê²½ìš°ëŠ” í”„ë¡œë¯¸ìŠ¤ê°€ ìƒì„±ë˜ë©´ ë°”ë¡œ executorê°€ ì‹¤í–‰ëœë‹¤. í´ë¦­ì´ë²¤íŠ¸ë¡œ í”„ë¡œë¯¸ìŠ¤ ì²˜ë¦¬í•˜ê³ ì‹¶ìœ¼ë©´ ë‹¤ë¥´ê²Œ ì²˜ë¦¬í•´ì•¼í•œë‹¤.
   const promise = new Promise((resolve,reject)=>{
   //doing some heavy work (network, read files)
   console.log('doing something...')
   setTimeout(()=>{
   resolve('ellie');
   <!-- reject(new Error('no network')) -->

   },2000);
   });

2. Consumers: then, catch, finally
   promise
   .then(value=>{
   console.log(value);
   })
   .catch(error=>{
   console.log(error);
   })
   //ì„±ê³µ ì‹¤íŒ¨ì™€ ìƒê´€ì—†ì´ ì–´ë–¤ê²ƒì„ ë§ˆì§€ë§‰ìœ¼ë¡œ ì‹¤í–‰í•˜ê³ ì‹¶ì„ë•Œ finallyë¥¼ ì“´ë‹¤.
   .finally(()=>{
   console.log('finally`);
   });

3. Promise chaining
   const fetchNumber = new Promise((resolve,reject) => {
   setTimeout(()=>resolve(1),1000);
   });
   fetchNumber
   .then(num => num*2)
   .then(num => num*3)
   .then (num-=>{
   return new Promise((resolve,reject)=>{
   setTimeout(()=>resolve(num-1),1000);
   });
   })
   .then(num=>console.log(num));

4.Error Handling

    const getHen=()=>
        new Promise ((resolve,reject)=>{
            setTimeout(()=>resolve('ğŸ“'),1000);
        });
    const getEgg=hen=>
        new Promise ((resolve,reject)=>{
            setTimeout(()=>resolve(`${hen}=>ğŸ¥š`),1000);
        });
    const cook=egg=>
        new Promise ((resolve,reject)=>{
            setTimeout(()=>resolve(`${egg}=>ğŸ³`),1000);
        });
    getHen()//
        .then(hen=>getEgg(hen))
        .then(egg=>cook(egg))
        .then(meal=>console.log(meal));
        ===
         //ë°›ì•„ì˜¤ëŠ” valueë¥¼ ë°”ë¡œ ë‹¤ìŒí•¨ìˆ˜ì— ì „ë‹¬í•˜ëŠ” ê²½ìš° value ìƒëµ ê°€ëŠ¥.
        .then(getEgg)
        //ì—ëŸ¬ í•¸ë“¤ë§ : ìœ„ì—ì„œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ ì¡ê³ ì‹¶ìœ¼ë©´ ë°‘ì— catchë¥¼ ë„£ì–´ì„œ ì—ëŸ¬ê°€ ë°œìƒí–ˆì„ë•Œ ëŒ€ì²˜í• ìˆ˜ìˆëŠ” ë°ì´í„°ë¥¼ ë„£ì–´ì¤Œìœ¼ë¡œì¨ ì—ëŸ¬ë¥¼ í•¸ë“¤ë§í•œë‹¤.
        .catch(error=>{
            return 'ğŸ';
        });
        .then(cook)
        .then(console.log)
        .catch(console.log);
        //ë§ˆì§€ë§‰ì— ì—ëŸ¬ê°€ ë‚˜ì˜¤ê²Œ í• ìˆ˜ë„ìˆìœ¼ë‚˜ ì—ëŸ¬ í•¸ë“¤ë§ì´ ë˜ì§€ì•Šì•„ì„œ ë§ˆì§€ë§‰ê¹Œì§€ í•¨ìˆ˜ê°€ ì™„ì„±ë˜ì§€ ì•ŠëŠ”ë‹¤.

###### Callback to Promise

    class UserStorage{
        loginUser(id,password){
            return new Promise((resolve,reject)=>{
                setTimeout(()=>{
                    if(
                        (id==="ellie" && password==="dream")||
                        (id==="coder" && password==="academy")
                    ) {
                        resolve('id')
                    } else {
                        reject(new Error('not found'));
                    }
                },2000)
            }
        }
        getRoles(user){
            return new Promise((resolve,reject)=>{
                setTimeout(()=>{
                    if(user==="ellie"){
                        resolve({name:"ellie",role:"admin"});
                    }else{
                        reject(new Error('no acess'));
                    }
                },1000)
            }
        }
    }
    const useStorage= new UserStorage();
    const id =prompt('enter your id');
    const password =propmt('enter you password');

    userStorage//
        .loginUser(id,password)
        .then(userStorage.getRoles)
        .then(user->alert(`Hello ${user.name}, you have a ${user.role} role`))
        .catch(console.log);

### 13. async & await

//syntactic sugar, clear style of using promise.

1.async

    //ë™ê¸°ì²˜ë¦¬
    function fetchUser(){
        //do network request in 10 secs...
        // ë™ê¸°ì²˜ë¦¬í•˜ê¸°ë•Œë¬¸ì— 10ì´ˆë™ì•ˆ ì´ì½”ë“œì—ì„œ ì•„ë¬´ê²ƒë„ ì•ˆí•˜ê³  ë¨¸ë­„ => í”„ë¡œë¯¸ìŠ¤ë¡œ ë¹„ë™ê¸° ì²˜ë¦¬í•´ì¤Œ.
        return 'ellie';
    }
    const user = fetchUser();
    console.log(user);

    //promiseì¶”ê°€ (ë¹„ë™ê¸°ì²˜ë¦¬)
    function fetchUser(){
        return new Promise((resolve,reject)=>{
            resolve('ellie')
        })
    }
    const user = fetchUser();
    user.then(console.log);
    console.log(user);

    //async & awaitì¶”ê°€
    async function fetchUser(){
           return 'ellie';
        }
    }
    const user = fetchUser();
    user.then(console.log);
    console.log(user);

2.awaitâœ¨

    function delay(ms){
        return new Promise(resolve=>setTimeout(resolve,ms));
    }

    async function getApple(){
        await delay(1000);
        return 'apple';
    }

    async function getBanana(){
        await delay(1000);
        return 'banana';
    }
    //ì½œë°±ì§€ì˜¥ì²˜ëŸ¼ í”„ë¡œë¯¸ìŠ¤ ì§€ì˜¥ì´ ëœë‹¤.
    function pickFruits(){
        return getApple().then(apple=>{
            return getBanana().then(banana=>`${apple}+${banana}`);
        });
    }

    async function pickFruits(){
        try{
        //ë™ê¸° ì²˜ë¦¬ í•¨(ì“¸ë°ì—†ëŠ” ì²˜ë¦¬)
        const apple =await getApple();
        const banana=await getBanana();
        return `${apple}+${banana}`
    }catch{
        (error)=>console.log(error)
    }
    pickFruits().then(console.log)

    async function pickFruits(){
        try{
        //ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰í• ìˆ˜ìˆëŠ”ê²½ìš° í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°”ë¡œ ì‹¤í–‰ì‹œì¼œ ë¹„ë™ê¸°ì²˜ë¦¬í•¨
        const applePromise=getApple();
        const bananaPromise=getBanana();
        const apple =await applePromise;
        const banana=await bananaPromise;
        return `${apple}+${banana}`
    }catch{
        (error)=>console.log(error)
    }
    pickFruits().then(console.log)

    //ë³‘ë ¬ì ìœ¼ë¡œ ì‹¤í–‰í• ìˆ˜ìˆëŠ”ê²½ìš° í”„ë¡œë¯¸ìŠ¤ë¥¼ ë°”ë¡œ ì‹¤í–‰ì‹œì¼œ ë¹„ë™ê¸°ì²˜ë¦¬í•¨ -> ì´ê²½ìš° promiseì— ìˆëŠ” allAPIë¥¼ í†µí•´ ë” ê°„ê²°í•˜ê²Œ ì²˜ë¦¬í• ìˆ˜ìˆë‹¤.
    async function pickFruits(){
    function pickFruits() {
        retrun Promise.all([getApple(),getBanana()])
        .then(fruits=>fruits.join('+'));
    }

    pickAllFruits().then(console.log);

    //Promise race Api = Promiseì— ì „ë‹¬í•œ í•¨ìˆ˜ì¤‘ ê°€ì¥ ë¨¼ì € ë¦¬í„´í•œ í•¨ìˆ˜ì˜ ê°’ì´ ë¦¬í„´ëœë‹¤.
    fuction pickOnlyOne(){
        return Promise.race([getApple(),getBanana()]);
    }

###### promise to async & await

    const useStorage= new UserStorage();
    const id =prompt('enter your id');
    const password =propmt('enter you password');

    async function checkUser(){
        try{
            const id=await serStorage.loginUser(id,password);
            const user=await userStorage.getRoles(id);
            return alert(`Hello ${user.name}, you have a ${user.role} role`)
            }
        catch(error){
            console.log(error)
        }
    }
    checkUser();

#### 2021-12-29 To Do List
